(function(){"use strict";var t={7415:function(t,e,n){var s=n(9242),i=n(3396),a=n(7139),o=n(7718),r=n(702),l=n(4075),u=n(1539),d=n(3289),c=n(6613),h=n(9457),g=n(3140),m=n(5848);const p={key:0,class:"login-box"},w=(0,i._)("h1",null,"欢迎来到小狼窝",-1),f=(0,i._)("img",{src:"http://qiming.hust.edu.cn/__local/A/A6/8E/98BB6679033FA4134BF39F840D7_0043A688_4077.jpg",alt:"avatar",class:"avatar"},null,-1),k=(0,i._)("div",null,null,-1),D=(0,i._)("h2",null,"负责人",-1),y={class:"MyCard"},_=["onClick"],T=(0,i._)("h2",null,"当前占用",-1),v={key:0},U={key:1},I=(0,i._)("h2",null,"任务",-1),b={class:"MyCard"},C=(0,i._)("td",{class:"font-weight-bold"},"任务名",-1),W=(0,i._)("td",{class:"font-weight-bold"},"简述",-1),x=(0,i._)("td",{class:"font-weight-bold"},"开始时间",-1),A=(0,i._)("td",{class:"font-weight-bold"},"预期时间",-1),S=(0,i._)("td",{class:"font-weight-bold"},"完成进度",-1),O=(0,i._)("td",{class:"font-weight-bold"},"时间进度",-1),G=(0,i._)("td",{class:"font-weight-bold"},"查看详情",-1),B=["onClick"],E=["onClick"],z=["onClick"],N=["onClick"],V=["onClick"],j=(0,i._)("h3",null,"负责人",-1),M={class:"MyCard"},P=(0,i._)("h3",null,"文档",-1);function J(t,e,n,s,J,L){const R=(0,i.up)("SidebarDisplay"),Z=(0,i.up)("alert-box"),q=(0,i.up)("InputBox"),F=(0,i.up)("StatusDisplay"),H=(0,i.up)("TaskDisplay"),$=(0,i.up)("v-md-editor"),Y=(0,i.up)("v-md-preview");return(0,i.wg)(),(0,i.j4)(o.q,null,{default:(0,i.w5)((()=>[J.loggedIn?((0,i.wg)(),(0,i.j4)(R,{key:0,unitGroups:J.unitGroup,loggedIn:J.loggedIn,avatar:J.avatar,currentUser:J.currentUser,onSelectTask:L.selectUnitGroup,title:J.currentTitle},null,8,["unitGroups","loggedIn","avatar","currentUser","onSelectTask","title"])):(0,i.kq)("",!0),(0,i.Wm)(Z,{"show-dialog":J.showDialog,"onUpdate:showDialog":e[0]||(e[0]=t=>J.showDialog=t),message:J.alertMessage},null,8,["show-dialog","message"]),(0,i.Wm)(q,{modelValue:J.showInputBox,"onUpdate:modelValue":e[1]||(e[1]=t=>J.showInputBox=t),message:J.alertMessage,onUserInput:J.userInputSubmitted},null,8,["modelValue","message","onUserInput"]),(0,i.Wm)(g.O,null,{default:(0,i.w5)((()=>[(0,i.Wm)(u.K,null,{default:(0,i.w5)((()=>[J.loggedIn?J.loggedIn&&"UnitGroups"===J.currentPage?((0,i.wg)(),(0,i.j4)(c.i,{key:1},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.taskGroups,(t=>((0,i.wg)(),(0,i.j4)(h.l,{key:t.id},{default:(0,i.w5)((()=>[(0,i._)("h1",null,(0,a.zw)(t.name),1),(0,i._)("div",null,(0,a.zw)(t.progress),1),(0,i.Wm)(F,{task:t},null,8,["task"]),(0,i.Wm)(l.J,{class:"custom-divider"})])),_:2},1024)))),128))])),_:1})):J.loggedIn&&"UnitGroupDetail"===J.currentPage?((0,i.wg)(),(0,i.j4)(c.i,{key:2},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(J.currentUnitGroup.unitsList,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.ID},[(0,i._)("h1",null,(0,a.zw)(L.getUnit(t).DisplayName),1),D,(0,i._)("div",y,[(0,i.Wm)(r.T,{onClick:e=>L.throwInputBox("添加单位负责人",t,L.addUnitUserInCharge),color:"primary",class:"float-right"},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-plus-box")])),_:1})])),_:2},1032,["onClick"]),(0,i._)("table",null,[(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(L.getUnit(t).InChargeUsers,(e=>((0,i.wg)(),(0,i.iD)("tr",{key:e.ID},[(0,i._)("td",null,(0,a.zw)(L.getUser(e).DisplayName),1),(0,i._)("td",null,(0,a.zw)(J.techGroup[L.getUser(e).TechGroup[0]].name),1),(0,i._)("td",{onClick:n=>L.deleteUnitUserInCharge(e,t)},[(0,i.Wm)(r.T,null,{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-account-multiple-remove-outline")])),_:1})])),_:1})],8,_)])))),128))])])]),T,-1===L.getUnit(t).CurrentUserID?((0,i.wg)(),(0,i.iD)("div",v,"无")):((0,i.wg)(),(0,i.iD)("div",U,(0,a.zw)(console.log(J.users))+" "+(0,a.zw)(L.getUser(L.getUnit(t).CurrentUserID).DisplayName),1)),(0,i.Wm)(l.J,{class:"custom-divider"}),I,(0,i._)("div",b,[(0,i.Wm)(r.T,{onClick:e=>L.addTask(t),color:"primary",class:"float-right"},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-plus-box")])),_:1})])),_:2},1032,["onClick"]),(0,i._)("table",null,[(0,i._)("tbody",null,[C,W,x,A,S,O,G,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(L.getUnit(t).InProgressTasks,(t=>((0,i.wg)(),(0,i.iD)("tr",{key:t},[(0,i._)("td",{onClick:e=>L.throwInputBox("修改任务名称",L.getTask(t),L.updateTaskName)},(0,a.zw)(L.getTask(t).Name),9,B),(0,i._)("td",{onClick:e=>L.throwInputBox("修改任务简述",L.getTask(t),L.updateTaskDescription)},(0,a.zw)(L.getTask(t).Description),9,E),(0,i._)("td",{onClick:e=>L.throwInputBox("修改任务开始时间（2023-08-26 22:43:00）",L.getTask(t),L.updateTaskStartTime)},(0,a.zw)(L.getTask(t).StartTime),9,z),(0,i._)("td",{onClick:e=>L.throwInputBox("修改任务预期时间（2023-08-26 22:43:00）",L.getTask(t),L.updateTaskDeadLine)},(0,a.zw)(L.getTask(t).DeadLine),9,N),(0,i._)("td",{onClick:e=>L.throwInputBox("格式为0.3",L.getTask(t),L.updateTaskProgress)},(0,a.zw)((100*L.getTask(t).Progress).toFixed(0))+"%",9,V),(0,i._)("td",null,(0,a.zw)(((Date.now()-L.stringToTime(L.getTask(t).StartTime))/(L.stringToTime(L.getTask(t).DeadLine)-L.stringToTime(L.getTask(t).StartTime))*100).toFixed(2))+"%",1),(0,i._)("td",null,[(0,i.Wm)(r.T,{onClick:e=>L.selectTask(t)},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-arrow-right")])),_:1})])),_:2},1032,["onClick"])])])))),128))])])]),(0,i.Wm)(l.J,{class:"custom-divider"})])))),128)),(0,i._)("h2",null,[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-check-all")])),_:1}),(0,i.Uk)(" 任务")]),(0,i.Wm)(H,{users:J.users,tasks:J.unitGroup[J.selectedUnitGroup].tasks},null,8,["users","tasks"]),(0,i.Wm)(l.J,{class:"custom-divider"}),(0,i._)("h2",null,[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-comment-account-outline")])),_:1}),(0,i.Uk)(" 留言")])])),_:1})):J.loggedIn&&"TaskDetail"===J.currentPage?((0,i.wg)(),(0,i.iD)(i.HY,{key:3},[(0,i.Wm)(r.T,{onClick:e[5]||(e[5]=t=>L.selectUnitGroup(J.selectedUnitGroup)),color:"primary",class:"float-right"},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-arrow-left")])),_:1})])),_:1}),(0,i._)("h1",null,(0,a.zw)(L.getUnit(L.getTask(J.selectedTask).BindUnitID).DisplayName),1),(0,i.Wm)(l.J,{class:"custom-divider"}),(0,i._)("h2",null,(0,a.zw)(L.getTask(J.selectedTask).Name),1),(0,i.Uk)(" "+(0,a.zw)(L.getTask(J.selectedTask).Description)+" ",1),j,(0,i._)("div",M,[(0,i.Wm)(r.T,{onClick:e[6]||(e[6]=e=>L.throwInputBox("添加单位负责人",t.unit,L.addTaskUserInCharge)),color:"primary",class:"float-right"},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-plus-box")])),_:1})])),_:1}),(0,i._)("table",null,[(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(L.getTask(J.selectedTask).InChargeUsers,(t=>((0,i.wg)(),(0,i.iD)("tr",{key:t.ID},[(0,i._)("td",null,(0,a.zw)(L.getUser(t).DisplayName),1),(0,i._)("td",null,(0,a.zw)(J.techGroup[L.getUser(t).TechGroup[0]].name),1)])))),128))])])]),P,J.editMode?((0,i.wg)(),(0,i.j4)($,{key:0,modelValue:L.getDocument(L.getTask(J.selectedTask).DocumentID).MarkdownBody,"onUpdate:modelValue":e[7]||(e[7]=t=>L.getDocument(L.getTask(J.selectedTask).DocumentID).MarkdownBody=t),onSave:L.editFile,height:"400px"},null,8,["modelValue","onSave"])):((0,i.wg)(),(0,i.j4)(Y,{key:1,text:L.getDocument(L.getTask(J.selectedTask).DocumentID).MarkdownBody},null,8,["text"])),J.editMode?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(r.T,{key:2,onClick:e[8]||(e[8]=t=>J.editMode=!0),color:"primary",class:"float-right"},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-file-edit-outline")])),_:1})])),_:1})),J.editMode?((0,i.wg)(),(0,i.j4)(r.T,{key:3,onClick:e[9]||(e[9]=t=>J.editMode=!1),color:"primary",class:"float-right"},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-swap-horizontal")])),_:1})])),_:1})):(0,i.kq)("",!0)],64)):(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",p,[w,f,(0,i.Wm)(m.h,{modelValue:J.username,"onUpdate:modelValue":e[2]||(e[2]=t=>J.username=t),label:"用户名",class:"login-box-text-field"},null,8,["modelValue"]),(0,i.Wm)(m.h,{modelValue:J.password,"onUpdate:modelValue":e[3]||(e[3]=t=>J.password=t),label:"密码",type:"password",class:"login-box-text-field"},null,8,["modelValue"]),(0,i.Wm)(r.T,{onClick:e[4]||(e[4]=t=>L.logIn(J.username,J.password)),color:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)("登陆")])),_:1}),k]))])),_:1})])),_:1})])),_:1})}var L=n(680),R=(n(8556),n(11)),Z=n(6572),q=n(1888);const F={class:"list-status"},H={class:"status-quantity"},$={class:"status-ddl"},Y=(0,i._)("strong",null,"DDL",-1),K={class:"status-remaining-time"};function Q(t,e,n,s,o,r){return(0,i.wg)(),(0,i.iD)("ul",F,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.task.status,(t=>((0,i.wg)(),(0,i.iD)("li",{key:t.id,class:"status mx-auto my-auto"},[(0,i.Wm)(R._,null,{default:(0,i.w5)((()=>[(0,i.Wm)(Z.E,{class:"yellow"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.name),1)])),_:2},1024),(0,i.Wm)(q.Z,null,{default:(0,i.w5)((()=>[(0,i._)("div",H,(0,a.zw)(t.quantity),1),(0,i._)("div",$,[Y,(0,i.Uk)(": "+(0,a.zw)(t.ddl),1)]),(0,i._)("div",K,"剩余时间："+(0,a.zw)(r.displayRemainTime(r.stringToTime(t.ddl)-Date.now())),1)])),_:2},1024)])),_:2},1024)])))),128))])}var X=n(4406),tt={props:{task:{id:1,name:"英雄",progress:"机械占用",description:"当前算法占用调辅瞄，预期2023-08-16晚结束",comments:[{id:1,user:"张三",message:"弹速今天不稳定:(",time:"2023-08-15 10:10:10"},{id:2,user:"李四",message:"辅瞄不稳",time:"2023-08-15 10:11:10"},{id:3,user:"王五",message:"零飘严重",time:"2023-08-15 10:12:10"}],status:[{id:1,name:"机械",quantity:"云台画图中",ddl:"2023-08-20 10:10:14"},{id:2,name:"嵌软",quantity:"摩擦轮PID调试",ddl:"2023-08-23 20:10:12"},{id:3,name:"电路",quantity:"画图中",ddl:"2023-08-24 03:10:13"},{id:4,name:"算法",quantity:"前哨战测试",ddl:"2023-08-25 15:10:11"}]}},methods:{stringToTime(t){const[e,n]=t.split(" "),[s,i,a]=e.split("-"),[o,r,l]=n.split(":"),u=new Date(s,i-1,a,o,r,l);return u},displayRemainTime(t){const e=(0,X.Z)(t,"dd天HH小时mm分钟");return e},selectTask(t){this.selectedTask=t,this.currentPage="taskDetail"}}},et=n(89);const nt=(0,et.Z)(tt,[["render",Q]]);var st=nt,it=n(6281),at=n(2127),ot=n(9657),rt=n(5030);const lt={key:0};function ut(t,e,n,s,o,u){const g=(0,i.up)("v-list-item-icon"),m=(0,i.up)("v-list-item-content"),p=(0,i.up)("login-status");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(ot.V,{app:"",modelValue:o.drawerOpen,"onUpdate:modelValue":e[1]||(e[1]=t=>o.drawerOpen=t),width:180,class:"sidebar"},{default:(0,i.w5)((()=>[(0,i.Wm)(h.l,{class:"sidebar-header",onClick:e[0]||(e[0]=t=>u.selectTask(0))},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-home")])),_:1}),(0,i.Uk)(" LY manager ")])),_:1}),(0,i.Wm)(l.J),(0,i.Wm)(c.i,{dense:""},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.unitGroups,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.id},[t.id>=1?((0,i.wg)(),(0,i.iD)("div",lt,[(0,i.Wm)(h.l,{onClick:e=>u.selectTask(t.id)},{default:(0,i.w5)((()=>[(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.icon),1)])),_:2},1024)])),_:2},1024),(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Wm)(at.V,{class:"align-content-center"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])):(0,i.kq)("",!0)])))),128))])),_:1}),(0,i.Wm)(p,{user:n.currentUser,avatar:n.avatar,loggedIn:n.loggedIn},null,8,["user","avatar","loggedIn"])])),_:1},8,["modelValue"]),(0,i.Wm)(it.L,{app:""},{default:(0,i.w5)((()=>[(0,i.Wm)(r.T,{icon:"",onClick:u.toggleDrawer},{default:(0,i.w5)((()=>[(0,i.Wm)(d.t,null,{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-menu")])),_:1})])),_:1},8,["onClick"]),(0,i.Wm)(rt.q,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(n.title),1)])),_:1})])),_:1})],64)}var dt=n(652),ct=n(8694);const ht={key:0,class:"login-info"},gt={class:"user-details"},mt={key:0},pt={class:"user-name"},wt={key:1},ft={class:"user-name"},kt={key:1,class:"login-info"},Dt=(0,i._)("div",{class:"user-status"},"Not Logged In",-1);function yt(t,e,s,o,l,u){return(0,i.wg)(),(0,i.iD)("div",{onClick:e[0]||(e[0]=t=>u.loginPage())},[s.loggedIn?((0,i.wg)(),(0,i.iD)("div",ht,[(0,i.Wm)(dt.V,null,{default:(0,i.w5)((()=>[(0,i.Wm)(ct.f,{src:n(1736),alt:"avatar"},null,8,["src"])])),_:1}),(0,i._)("div",gt,[s.user.TechGroup.length>0?((0,i.wg)(),(0,i.iD)("div",mt,[(0,i._)("div",pt,(0,a.zw)(l.techGroups[s.user.TechGroup[0]].name)+" - "+(0,a.zw)(s.user.DisplayName),1)])):((0,i.wg)(),(0,i.iD)("div",wt,[(0,i._)("div",ft,(0,a.zw)(s.user.DisplayName),1)]))])])):((0,i.wg)(),(0,i.iD)("div",kt,[Dt,(0,i.Wm)(r.T,{color:"primary",onClick:t.login},{default:(0,i.w5)((()=>[(0,i.Uk)("Login")])),_:1},8,["onClick"])]))])}var _t={props:{user:null,avatar:null,loggedIn:null},data(){return{unitGroups:[{name:"未知",id:"0"},{name:"英雄",id:"1"},{name:"工程",id:"2"},{name:"步兵",id:"3"},{name:"哨兵",id:"4"},{name:"无人机",id:"5"},{name:"飞镖",id:"6"}],techGroups:[{name:"未知",id:"0"},{name:"机械",id:"1"},{name:"电路",id:"2"},{name:"嵌软",id:"3"},{name:"算法",id:"4"},{name:"管理",id:"5"}]}},methods:{loginPage(){this.$emit("selectTask",-1)}}};const Tt=(0,et.Z)(_t,[["render",yt]]);var vt=Tt,Ut={data(){return{drawerOpen:!0}},components:{LoginStatus:vt},props:{unitGroups:null,loggedIn:null,avatar:String,currentUser:null,title:null},methods:{selectTask(t){this.$emit("selectTask",t)},toggleDrawer(){this.drawerOpen=!this.drawerOpen}}};const It=(0,et.Z)(Ut,[["render",ut]]);var bt=It;const Ct={class:"list-status"},Wt={class:"status-quantity"},xt={class:"status-ddl"},At=(0,i._)("strong",null,"DDL",-1),St={class:"status-remaining-time"},Ot={class:"timeRemainRatio"},Gt={class:"progress"};function Bt(t,e,n,s,o,r){return(0,i.wg)(),(0,i.iD)("ul",Ct,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.tasks,(s=>((0,i.wg)(),(0,i.iD)("li",{key:s.id,class:"status mx-auto my-auto"},[(0,i.Wm)(R._,{onClick:e[0]||(e[0]=e=>t.fetchDetail())},{default:(0,i.w5)((()=>[(0,i.Wm)(Z.E,{class:"yellow"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(s.name),1)])),_:2},1024),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.users,(t=>((0,i.wg)(),(0,i.j4)(h.l,{key:t.id},{default:(0,i.w5)((()=>[(0,i.Wm)(at.V,{class:"align-content-center"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(n.users[t].name),1)])),_:2},1024)])),_:2},1024)))),128)),(0,i.Wm)(q.Z,null,{default:(0,i.w5)((()=>[(0,i._)("div",Wt,(0,a.zw)(s.quantity),1),(0,i._)("div",xt,[At,(0,i.Uk)(": "+(0,a.zw)(s.ddl),1)]),(0,i._)("div",St,"剩余："+(0,a.zw)(r.displayTime(r.stringToTime(s.ddl)-Date.now())),1),(0,i._)("div",Ot,"距离结束还剩"+(0,a.zw)(((r.stringToTime(s.ddl)-Date.now())/(r.stringToTime(s.ddl)-r.stringToTime(s.st))*100).toFixed(1))+"%的时间",1),(0,i._)("div",Gt,"还有"+(0,a.zw)((100*(1-s.progress)).toFixed(1))+"%的工作未完成",1)])),_:2},1024)])),_:2},1024)])))),128))])}var Et={props:{users:null,tasks:null},methods:{stringToTime(t){console.log(t);const[e,n]=t.split(" "),[s,i,a]=e.split("-"),[o,r,l]=n.split(":"),u=new Date(s,i-1,a,o,r,l);return u},displayTime(t){if(!(t<0)){const e=Math.floor(t/1e3/60/60/24),n=Math.floor(t/1e3/60/60%24),s=Math.floor(t/1e3/60%60),i=Math.floor(t/1e3%60);return`${e}天${n}小时${s}分钟${i}秒`}},selectTask(t){this.selectedTask=t,this.currentPage="taskDetail"}}};const zt=(0,et.Z)(Et,[["render",Bt]]);var Nt=zt,Vt=n(1334),jt=n(713),Mt=n(9234);const Pt={class:"headline"};function Jt(t,e,n,s,o,l){return(0,i.wg)(),(0,i.j4)(jt.B,{modelValue:o.dialogVisible,"onUpdate:modelValue":e[1]||(e[1]=t=>o.dialogVisible=t),"max-width":"500px"},{default:(0,i.w5)((()=>[(0,i.Wm)(R._,null,{default:(0,i.w5)((()=>[(0,i.Wm)(Z.E,null,{default:(0,i.w5)((()=>[(0,i._)("span",Pt,(0,a.zw)(n.message),1)])),_:1}),(0,i.Wm)(q.Z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(m.h,{modelValue:o.userInput,"onUpdate:modelValue":e[0]||(e[0]=t=>o.userInput=t),label:"输入",required:""},null,8,["modelValue"])])),_:1}),(0,i.Wm)(Vt.h,null,{default:(0,i.w5)((()=>[(0,i.Wm)(Mt.C),(0,i.Wm)(r.T,{color:"primary",onClick:l.closeDialog},{default:(0,i.w5)((()=>[(0,i.Uk)("取消")])),_:1},8,["onClick"]),(0,i.Wm)(r.T,{color:"primary",onClick:l.submitUserInput},{default:(0,i.w5)((()=>[(0,i.Uk)("确认")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var Lt={props:{value:Boolean,message:null},data(){return{dialogVisible:this.value,userInput:""}},watch:{value(t){this.dialogVisible=t}},methods:{closeDialog(){this.dialogVisible=!1,this.userInput="",this.$emit("user-input",null)},submitUserInput(){""!==this.userInput.trim()&&(console.log("用户输入:",this.userInput),this.$emit("user-input",this.userInput))}}};const Rt=(0,et.Z)(Lt,[["render",Jt]]);var Zt=Rt;function qt(t,e,n,s,o,l){return(0,i.wg)(),(0,i.j4)(jt.B,{modelValue:o.internalShowDialog,"onUpdate:modelValue":e[0]||(e[0]=t=>o.internalShowDialog=t),"max-width":"400"},{default:(0,i.w5)((()=>[(0,i.Wm)(R._,null,{default:(0,i.w5)((()=>[(0,i.Wm)(Z.E,{class:"headline"},{default:(0,i.w5)((()=>[(0,i.Uk)("提示")])),_:1}),(0,i.Wm)(q.Z,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(n.message),1)])),_:1}),(0,i.Wm)(Vt.h,null,{default:(0,i.w5)((()=>[(0,i.Wm)(r.T,{color:"primary",text:"",onClick:l.closeDialog},{default:(0,i.w5)((()=>[(0,i.Uk)("关闭")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var Ft={props:{message:String,showDialog:Boolean},data(){return{internalShowDialog:this.showDialog}},methods:{closeDialog(){this.internalShowDialog=!1,this.$emit("update:showDialog",!1)}},watch:{showDialog(t){this.internalShowDialog=t}}};const Ht=(0,et.Z)(Ft,[["render",qt]]);var $t=Ht,Yt=n(220),Kt={computed:{task(){return Yt.task}},components:{SidebarDisplay:bt,StatusDisplay:st,TaskDisplay:Nt,AlertBox:$t,InputBox:Zt},data(){return{userToken:L.Z.get("user_token")||"",currentTitle:null,userInputSubmitted:null,connected:!0,loggedIn:!1,showDialog:!1,showInputBox:!1,alertMessage:null,dialogVisible:!1,userInput:"",currentUnitGroup:null,currentEdit:{father:null,son:null},unitGroup:[{name:"未知",id:0},{name:"英雄",id:1,unitsList:[]},{name:"工程",id:2},{name:"步兵",id:3},{name:"哨兵",id:4},{name:"无人机",id:5},{name:"飞镖",id:6}],techGroup:[{name:"未知",id:0},{name:"机械",id:1},{name:"电路",id:2},{name:"嵌软",id:3},{name:"算法",id:4},{name:"管理",id:5}],users:[],tasks:[],units:[],documents:[],currentDocumentID:null,editMode:null,username:null,password:null,currentUser:{Name:"root",DisplayName:"系统",TechGroup:[1],UnitGroup:[1],Authority:"System",Token:"token"},avatar:"../assets/img/34596177.jpg",name:"",currentPage:"TaskDetail",currentTasksList:[],selectedUnitGroup:null,selectedTask:null,newComment:"",socket:null}},methods:{stringToTime(t){console.log(t);const[e,n]=t.split(" "),[s,i,a]=e.split("-"),[o,r,l]=n.split(":"),u=new Date(s,i-1,a,o,r,l);return u},displayTime(t){if(!(t<0)){const e=Math.floor(t/1e3/60/60/24),n=Math.floor(t/1e3/60/60%24),s=Math.floor(t/1e3/60%60),i=Math.floor(t/1e3%60);return`${e}天${n}小时${s}分钟${i}秒`}},async sendAndReceiveData(t){return new Promise((e=>{this.socket.send(t),this.socket.addEventListener("message",(t=>{const n=t.data;console.log("Received message:",n),e(n)}))}))},async sendData(t){this.socket.send(t)},throwAlert(t){this.showDialog=!0,this.alertMessage=t},async addTask(t){const e=await this.sendAndReceiveData('+task {"BindUnitID":'+t+"}");await this.fetchTask([e])},async addUnitUserInCharge(t){if(null===t)return void(this.showInputBox=!1);const e=await this.sendAndReceiveData("!query user user_display_name "+t),n=JSON.parse(e);if("-"===e.charAt(0))this.throwAlert("用户不存在");else{if(this.getUnit(this.currentEdit).InChargeUsers.includes(n))return this.throwAlert("负责人已存在"),void(this.showInputBox=!1);this.getUnit(this.currentEdit).InChargeUsers.push(n),console.log("++++++"+this.getUnit(this.currentEdit).InChargeUsers),await this.sendData("!update unit "+this.currentEdit+" "+JSON.stringify(this.getUnit(this.currentEdit))),console.log("------"+this.getUnit(this.currentEdit).InChargeUsers)}this.showInputBox=!1},deleteUnitUserInCharge(t,e){this.getUnit(e).InChargeUsers.splice(this.getUnit(e).InChargeUsers.indexOf(t),1),this.sendData("!update unit "+e+" "+JSON.stringify(this.getUnit(e)))},async addTaskUserInCharge(t){if(null===t)return void(this.showInputBox=!1);const e=await this.sendAndReceiveData("!query user user_display_name "+t);"-"===e.charAt(0)?this.throwAlert("用户不存在"):(await this.fetchUser([e]),this.getUnit(this.currentEdit).InChargeUsers.push(e.ID),await this.sendData("!update unit "+this.currentEdit+" "+JSON.stringify(this.getUnit(this.currentEdit)))),this.showInputBox=!1},editFile(t){this.editMode=!0,this.getDocument(this.getTask(this.selectedTask).DocumentID).MarkdownBody=t;try{this.sendData("!update document "+this.getTask(this.selectedTask).DocumentID+" "+JSON.stringify(this.getDocument(this.getTask(this.selectedTask).DocumentID))),this.throwAlert("保存成功")}catch(e){this.throwAlert("服务器未响应")}},throwInputBox(t,e,n){this.showInputBox=!0,this.alertMessage=t,this.currentEdit=e,this.userInputSubmitted=n},async updateTaskProgress(t){if(null===t)return void(this.showInputBox=!1);this.currentEdit.Progress=t;const e=await this.sendAndReceiveData("!update task "+this.currentEdit.ID+" "+JSON.stringify(this.currentEdit));"-"===e.charAt(0)?this.throwAlert("无权限，请联系管理员"):this.throwAlert("更新成功"),this.showInputBox=!1},updateTaskDescription(t){null!==t?(this.currentEdit.Description=t,this.sendData("!update task "+this.currentEdit.ID+" "+JSON.stringify(this.currentEdit)),this.showInputBox=!1):this.showInputBox=!1},updateTaskName(t){null!==t?(this.currentEdit.Name=t,this.sendData("!update task "+this.currentEdit.ID+" "+JSON.stringify(this.currentEdit)),this.showInputBox=!1):this.showInputBox=!1},updateTaskDeadLine(t){null!==t?(this.currentEdit.DeadLine=t,this.sendData("!update task "+this.currentEdit.ID+" "+JSON.stringify(this.currentEdit)),this.showInputBox=!1):this.showInputBox=!1},updateTaskStartTime(t){null!==t?(this.currentEdit.StartTime=t,this.sendData("!update task "+this.currentEdit.ID+" "+JSON.stringify(this.currentEdit)),this.showInputBox=!1):this.showInputBox=!1},getUser(t){return console.log(this.users),this.users.find((e=>e.ID===t))},async fetchUser(t){for(let n of t){if(-1===n)continue;console.log("Fetch user "+n+".");const t=this.users.find((t=>t.ID===n));if(!t)try{const t=await this.sendAndReceiveData("?user id "+n);if("-"===t.charAt(0))return console.log("获取用户详情失败"),this.throwAlert("获取用户详情失败"),null;try{const e=JSON.parse(t);e.ID=n,this.users.push(e)}catch(e){this.throwAlert("Json解析错误")}}catch(e){this.throwAlert("用户不存在")}}},getTask(t){return console.log("Get task "+t+"."),this.tasks.find((e=>e.ID===t))},async fetchTask(t){for(let n of t){if(-1===n)continue;console.log("Fetch task "+n+".");const t=this.users.find((t=>t.id===n));if(!t)try{const t=await this.sendAndReceiveData("?task id "+n);if("-"===t.charAt(0))return console.log("获取任务详情失败"),this.throwAlert("获取任务详情失败"),null;try{const e=JSON.parse(t);await this.fetchUser(e.InChargeUsers),await this.fetchDocument([e.DocumentID]),e.ID=n,this.tasks.push(e)}catch(e){this.throwAlert("Json解析错误")}}catch(e){this.throwAlert("任务不存在")}}},getUnit(t){return console.log("Get unit "+t+"."),this.units.find((e=>e.ID===t))},async fetchUnit(t){for(let n of t){if(-1===n)continue;console.log("Fetch unit "+n+".");const t=this.units.find((t=>t.id===n));if(!t)try{const t=await this.sendAndReceiveData("?unit id "+n);if("-"===t.charAt(0))return console.log("获取单位详情失败"),this.throwAlert("获取单位详情失败"),null;try{const e=JSON.parse(t);e.ID=n,await this.fetchUser(e.InChargeUsers),await this.fetchUser([e.CurrentUserID]),await this.fetchTask(e.InProgressTasks),this.units.push(e)}catch(e){this.throwAlert("Json解析错误")}}catch(e){this.throwAlert("单位不存在")}}},getDocument(t){return console.log("Get document "+t+"."),this.documents.find((e=>e.ID===t))},async fetchDocument(t){for(let n of t){if(-1===n)continue;console.log("Fetch document "+n+".");const t=this.documents.find((t=>t.id===n));if(!t)try{const t=await this.sendAndReceiveData("?document id "+n);if("-"===t.charAt(0))return console.log("获取文档详情失败"),this.throwAlert("获取文档详情失败"),null;try{const e=JSON.parse(t);e.ID=n,this.documents.push(e)}catch(e){this.throwAlert("Json解析错误")}}catch(e){this.throwAlert("文档不存在")}}},async selectUnitGroup(t){if(console.log("Select unit group "+t+"."),0===t)this.currentPage="UnitGroups";else if(-1===t)this.loggedIn=!1;else{this.selectedUnitGroup=t,this.currentUnitGroup=this.unitGroup.find((e=>e.id===t)),this.currentTitle=this.currentUnitGroup.name+"组";try{const e=await this.sendAndReceiveData("?unit unit_group "+t);this.currentUnitGroup.unitsList=JSON.parse(e),await this.fetchUnit(this.currentUnitGroup.unitsList),console.log("Received response data:",e)}catch(e){console.error("Error:",e)}this.currentPage="UnitGroupDetail"}},selectTask(t){this.currentPage="TaskDetail",this.selectedTask=t,this.currentDocumentID=this.getTask(t).DocumentID},async logIn(t,e){console.log("Try login.");try{const s=await this.sendAndReceiveData("!login "+t+" "+e);if("-1"===s)this.throwAlert("未找到用户");else if("-2"===s)this.throwAlert("用户名或密码错误");else{try{this.currentUser=JSON.parse(s);const t=this.currentUser.Token,e=this.currentUser.Name;L.Z.set("user_name",e,{path:"/"}),L.Z.set("token",t,{path:"/"}),this.loggedIn=!0,console.log("Login success.")}catch(n){this.throwAlert("Json解析错误")}this.currentPage="UnitGroups",await this.selectUnitGroup(1)}}catch(n){this.throwAlert("服务器未响应")}},async autoLogIn(){const t=L.Z.get("token"),e=L.Z.get("user_name");if(console.log("Try auto login "+e+" "+t+"."),"-"===t)return;const n=await this.sendAndReceiveData("!login "+e+" "+t);if("-"===n.charAt(0))this.throwAlert("自动登录失败"),L.Z.set("user_name","-",{path:"/"}),L.Z.set("token","-",{path:"/"});else{try{this.currentUser=JSON.parse(n);const t=this.currentUser.Token,e=this.currentUser.Name;L.Z.set("user_name",e,{path:"/"}),L.Z.set("token",t,{path:"/"}),this.loggedIn=!0,console.log("Login success.")}catch(s){this.throwAlert("Json解析错误")}this.currentPage="UnitGroups",await this.selectUnitGroup(1)}}},testConnection(){const t=new WebSocket("ws://127.0.0.1:6363");t.addEventListener("open",(()=>{console.log("Connected to server."),t.send("!login root    "),t.send("?unit id 0")})),t.addEventListener("message",(t=>{console.log("Received message:",t.data)})),t.addEventListener("close",(t=>{console.log("Connection closed:",t.reason)}))},async created(){this.socket=new WebSocket("ws://182.92.120.146:8989"),this.socket.onerror=function(){console.log("连接失败"),this.connected=!1},this.socket.onopen=this.autoLogIn,this.editMode=!1}};const Qt=(0,et.Z)(Kt,[["render",J]]);var Xt=Qt,te=(n(9773),n(8727)),ee=(0,te.Rd)();async function ne(){const t=await n.e(461).then(n.t.bind(n,3657,23));t.load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}var se=n(7709),ie=n.n(se),ae=n(164),oe=n.n(ae),re=n(2549),le=n.n(re),ue=(n(9525),n(1973),n(1739),n(9498)),de=n.n(ue);de().use(oe(),{Prism:le()}),ie().use(oe(),{Prism:le()}),ne(),(0,s.ri)(Xt).use(de()).use(ee).use(ie()).mount("#app")},1736:function(t,e,n){t.exports=n.p+"img/34596177.05a1478a.jpg"}},e={};function n(s){var i=e[s];if(void 0!==i)return i.exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,n),a.exports}n.m=t,function(){var t=[];n.O=function(e,s,i,a){if(!s){var o=1/0;for(d=0;d<t.length;d++){s=t[d][0],i=t[d][1],a=t[d][2];for(var r=!0,l=0;l<s.length;l++)(!1&a||o>=a)&&Object.keys(n.O).every((function(t){return n.O[t](s[l])}))?s.splice(l--,1):(r=!1,a<o&&(o=a));if(r){t.splice(d--,1);var u=i();void 0!==u&&(e=u)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[s,i,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){var t,e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__};n.t=function(s,i){if(1&i&&(s=this(s)),8&i)return s;if("object"===typeof s&&s){if(4&i&&s.__esModule)return s;if(16&i&&"function"===typeof s.then)return s}var a=Object.create(null);n.r(a);var o={};t=t||[null,e({}),e([]),e(e)];for(var r=2&i&&s;"object"==typeof r&&!~t.indexOf(r);r=e(r))Object.getOwnPropertyNames(r).forEach((function(t){o[t]=function(){return s[t]}}));return o["default"]=function(){return s},n.d(a,o),a}}(),function(){n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,s){return n.f[s](t,e),e}),[]))}}(),function(){n.u=function(t){return"js/webfontloader.330b2b6b.js"}}(),function(){n.miniCssF=function(t){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="lymanager:";n.l=function(s,i,a,o){if(t[s])t[s].push(i);else{var r,l;if(void 0!==a)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var c=u[d];if(c.getAttribute("src")==s||c.getAttribute("data-webpack")==e+a){r=c;break}}r||(l=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,n.nc&&r.setAttribute("nonce",n.nc),r.setAttribute("data-webpack",e+a),r.src=s),t[s]=[i];var h=function(e,n){r.onerror=r.onload=null,clearTimeout(g);var i=t[s];if(delete t[s],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach((function(t){return t(n)})),e)return e(n)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=h.bind(null,r.onerror),r.onload=h.bind(null,r.onload),l&&document.head.appendChild(r)}}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.p=""}(),function(){var t={143:0};n.f.j=function(e,s){var i=n.o(t,e)?t[e]:void 0;if(0!==i)if(i)s.push(i[2]);else{var a=new Promise((function(n,s){i=t[e]=[n,s]}));s.push(i[2]=a);var o=n.p+n.u(e),r=new Error,l=function(s){if(n.o(t,e)&&(i=t[e],0!==i&&(t[e]=void 0),i)){var a=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;r.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",r.name="ChunkLoadError",r.type=a,r.request=o,i[1](r)}};n.l(o,l,"chunk-"+e,e)}},n.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,a,o=s[0],r=s[1],l=s[2],u=0;if(o.some((function(e){return 0!==t[e]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(l)var d=l(n)}for(e&&e(s);u<o.length;u++)a=o[u],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(d)},s=self["webpackChunklymanager"]=self["webpackChunklymanager"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(7415)}));s=n.O(s)})();
//# sourceMappingURL=app.c48b2ebe.js.map